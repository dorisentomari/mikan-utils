{"version":3,"file":"csv.js","sources":["../../../src/csv.ts"],"sourcesContent":["import { isPlainObject, isString } from './common';\n\n/**\n * 转换 CSV 为 JSON\n *\n * @param data\n * @param delimiter\n */\nexport function CSVtoJSON(data = '', delimiter = ',') {\n  if (isString(data)) {\n    if (data.length === 0) {\n      return {};\n    }\n    const firstLineIndex = data.indexOf('\\n');\n    const titles = data.slice(0, firstLineIndex).split(delimiter);\n    const restData = data.slice(firstLineIndex + 1);\n\n    return restData.split('\\n').map((v) => {\n      const values = v.split(delimiter);\n\n      return titles.reduce((prev: Record<any, any>, curr, index) => {\n        prev[curr] = values[index];\n        return prev;\n      }, {});\n    });\n  }\n\n  return {};\n}\n\n/**\n * 转换 JSON 为 CSV\n *\n * @param arr\n * @param columns\n * @param delimiter\n */\nexport function JSONtoCSV(arr = [], columns = [], delimiter = ',') {\n  for (let i = 0; i < arr.length; i++) {\n    const item = arr[i];\n    if (!isPlainObject(item)) {\n      throw new TypeError('数组元素必须是对象');\n    }\n  }\n\n  return [\n    columns.join(delimiter),\n    ...arr.map((obj) => {\n      return columns.reduce((prev, curr) => {\n        return `${prev}${prev.length ? delimiter : ''}${obj[curr]}`;\n      }, '');\n    }),\n  ]\n    .join('\\n')\n    .trim();\n}\n"],"names":[],"mappings":";;;AAEA;;;;;AAKG;AACa,SAAA,SAAS,CAAC,IAAS,EAAE,SAAe,EAAA;AAA1B,IAAA,IAAA,IAAA,KAAA,KAAA,CAAA,EAAA,EAAA,IAAS,GAAA,EAAA,CAAA,EAAA;AAAE,IAAA,IAAA,SAAA,KAAA,KAAA,CAAA,EAAA,EAAA,SAAe,GAAA,GAAA,CAAA,EAAA;AAClD,IAAA,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE;AAClB,QAAA,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;AACrB,YAAA,OAAO,EAAE,CAAC;SACX;QACD,IAAM,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC1C,QAAA,IAAM,QAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAC9D,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC;QAEhD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,UAAC,CAAC,EAAA;YAChC,IAAM,MAAM,GAAG,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;YAElC,OAAO,QAAM,CAAC,MAAM,CAAC,UAAC,IAAsB,EAAE,IAAI,EAAE,KAAK,EAAA;gBACvD,IAAI,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;AAC3B,gBAAA,OAAO,IAAI,CAAC;aACb,EAAE,EAAE,CAAC,CAAC;AACT,SAAC,CAAC,CAAC;KACJ;AAED,IAAA,OAAO,EAAE,CAAC;AACZ,CAAC;AAED;;;;;;AAMG;SACa,SAAS,CAAC,GAAQ,EAAE,OAAY,EAAE,SAAe,EAAA;AAAvC,IAAA,IAAA,GAAA,KAAA,KAAA,CAAA,EAAA,EAAA,GAAQ,GAAA,EAAA,CAAA,EAAA;AAAE,IAAA,IAAA,OAAA,KAAA,KAAA,CAAA,EAAA,EAAA,OAAY,GAAA,EAAA,CAAA,EAAA;AAAE,IAAA,IAAA,SAAA,KAAA,KAAA,CAAA,EAAA,EAAA,SAAe,GAAA,GAAA,CAAA,EAAA;AAC/D,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,QAAA,IAAM,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;AACpB,QAAA,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;AACxB,YAAA,MAAM,IAAI,SAAS,CAAC,WAAW,CAAC,CAAC;SAClC;KACF;IAED,OAAO,aAAA,CAAA;AACL,QAAA,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC;AACpB,KAAA,EAAA,GAAG,CAAC,GAAG,CAAC,UAAC,GAAG,EAAA;AACb,QAAA,OAAO,OAAO,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI,EAAA;YAC/B,OAAO,EAAA,CAAA,MAAA,CAAG,IAAI,CAAG,CAAA,MAAA,CAAA,IAAI,CAAC,MAAM,GAAG,SAAS,GAAG,EAAE,CAAG,CAAA,MAAA,CAAA,GAAG,CAAC,IAAI,CAAC,CAAE,CAAC;SAC7D,EAAE,EAAE,CAAC,CAAC;AACT,KAAC,CAAC,EAAA,IAAA,CAAA,CAED,IAAI,CAAC,IAAI,CAAC;AACV,SAAA,IAAI,EAAE,CAAC;AACZ;;;;"}